<script src="//mallmaverick.cdn.speedyrails.net/javascripts/mapsvg/jquery.js"></script>
<script src="//mallmaverick.cdn.speedyrails.net/javascripts/mapsvg/raphael.js"></script>
<script src="//mallmaverick.cdn.speedyrails.net/javascripts/mapsvg/jquery.mousewheel.js"></script>
<script src="//mallmaverick.cdn.speedyrails.net/system/site_images/photos/000/005/107/original/mallmaverick_svgmap.js?1412885524"></script>
<script>
    $(document).ready(function(){
        init();
        function renderPage(){
            var stores = getStoresList();
            
            $("#mapsvg").show();
            regions = {}
            $.each(stores, function(key, val) {
                if(val.svgmap_region != null && typeof(val.svgmap_region)  != 'undefined'){
                    obj = {};
                    obj["popover"] = "<img class='tooltip_img' src='" + val.store_front_url_abs + "'/><label class='store_name_map'>" + val.name + "</label>"
                    obj["attr"] = {}
                    regions[val.svgmap_region] = obj
                }
            });
            
            var map = $('#mapsvg').mapSvg({
                source: getSVGMapURL(),    // Path to SVG map
                colors: {stroke: '#aaaaaa', selected: -20, hover: "#d0e4ff"},
                disableAll: false,
                regions: regions,
                tooltipsMode:'custom',
                loadingText: "loading...",
                zoom: true,
                zoomButtons: {'show': true,'location': 'right' },
                pan:true,
                cursor:'pointer',
                responsive:true,
                zoomLimit: [0, 5],
                // viewBox:[350,-180,1600,870]
            });
        }
        loadMallDataCached(renderPage);
    });
</script>